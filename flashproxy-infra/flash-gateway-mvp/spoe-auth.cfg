###############################################################################
# SPOE agent definition – FlashProxy edge
# The auth-agent is running on a separate VM:
#   sdk.opsec-development.com :9000
###############################################################################

[spoe-agent auth-engine]
  timeout hello 3s
  timeout idle  30s
  messages      check_credentials
  option        var-prefix auth

  # ── remote agent(s) ───────────────────────────────────────────────────────
  server auth1 sdk.opsec-development.com:9000

[spoe-message check_credentials]
  # These vars are set in haproxy.cfg:
  #   req.username  – decoded Basic username
  #   req.password  – decoded Basic password
  args username=var(req.username) password=var(req.password)
